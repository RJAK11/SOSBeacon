<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Beacon</title>

    <style>
        body {
            text-align: center;
            font-family: monospace;
            padding-top: 20%;
        }

        .waiting {
            background-color: rgb(255, 210, 182);
            color: rgb(174, 9, 9);
            font-size: x-large;
        }

        .received {
            background-color: rgb(174, 9, 9);
            color: rgb(255, 210, 182);
            font-size: xx-large;
        }

        .ack_button {
            color: rgb(174, 9, 9);
            font-size: x-large;
            border-radius: 10px;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            background-color: rgb(255, 210, 182);
            display: none;
        }

        .ack_button:hover {
            background-color: rgb(254, 234, 222);
            color: rgb(98, 4, 4);
        }
    </style>


</head>

<body class="waiting">
    <h1>Listening for Any Incoming SOS Signals...</h1>
    <button id="ack_button" class="ack_button">Acknowledge</button>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.js"></script>
    <script>

        var socket = io();
        document.body.className = 'waiting';

        var btn = document.createElement("button");
        btn.innerText = 'Acknowledge';
        btn.className = 'ack_button';
        btn.id = 'ack_button';
        btn.className = 'ack_button';

        socket.on('connect', function () {
            console.log("hi")

        });
        socket.on('sos_received', function () {
            console.log("SOS received")
            document.body.className = 'received';
            document.body.innerHTML = '<h1>SOS SIGNAL RECEIVED</h1>';
            document.body.appendChild(btn);
            btn.style.display = 'inline-block';
        });

        btn.onclick = function () {
            console.log("Button pressed")
            socket.emit('acknowledge_signal', { data: 'SOS Signal Acknowledged' });
            document.body.className = 'waiting';
            document.body.innerHTML = '<h1>Listening for Any Incoming SOS Signals...</h1>';
            btn.style.display = 'none';
        };

        var maintainInterval = setInterval(function () {
            socket.emit('heartbeat');
        }, 30000);

        socket.on('interval_ack', function () {
            console.log('Interval acknowledged');
        });

        socket.on('disconnect', function () {
            clearInterval(maintainInterval);
        });

    </script>
</body>

</html>